<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v7.7: Exotic Quadrature</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="tasmanian.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
    <div class="doxygen">
            <a href="http://www.doxygen.org/index.html">
                <img class="footer" src="doxygen.png" alt="doxygen"/>
                </a> 1.8.17
    </div>
   <div id="projectname">Toolkit for Adaptive Stochastic Modeling and Non-Intrusive ApproximatioN: Tasmanian v7.7
           <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__TasmanianAddonsExoticQuad.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Exotic Quadrature<div class="ingroups"><a class="el" href="group__TasmanianAddons.html">Additional Capabilities</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Exotic Quadrature:</div>
<div class="dyncontent">
<div class="center"><img src="group__TasmanianAddonsExoticQuad.png" border="0" usemap="#group____TasmanianAddonsExoticQuad" alt=""/></div>
<map name="group____TasmanianAddonsExoticQuad" id="group____TasmanianAddonsExoticQuad">
<area shape="rect" href="group__TasmanianAddons.html" title=" " alt="" coords="5,5,156,31"/>
<area shape="rect" title=" " alt="" coords="204,5,331,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2cfd0f3dda72fcacc6288ddae24e2d19"><td class="memItemLeft" align="right" valign="top">TasGrid::CustomTabulated&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TasmanianAddonsExoticQuad.html#ga2cfd0f3dda72fcacc6288ddae24e2d19">TasGrid::getExoticQuadrature</a> (const int num_levels, const double shift, const <a class="el" href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a> &amp;grid, const char *description, const bool is_symmetric=false)</td></tr>
<tr class="memdesc:ga2cfd0f3dda72fcacc6288ddae24e2d19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an exotic quadrature from a sparse grid object.  <a href="group__TasmanianAddonsExoticQuad.html#ga2cfd0f3dda72fcacc6288ddae24e2d19">More...</a><br /></td></tr>
<tr class="separator:ga2cfd0f3dda72fcacc6288ddae24e2d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61aaac9fcfbb38c259453c3029f20cc0"><td class="memItemLeft" align="right" valign="top">TasGrid::CustomTabulated&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TasmanianAddonsExoticQuad.html#ga61aaac9fcfbb38c259453c3029f20cc0">TasGrid::getExoticQuadrature</a> (const int num_levels, const double shift, std::function&lt; double(double)&gt; weight_fn, const int num_ref_points, const char *description, const bool is_symmetric=false)</td></tr>
<tr class="memdesc:ga61aaac9fcfbb38c259453c3029f20cc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similar to <a class="el" href="group__TasmanianAddonsExoticQuad.html#ga2cfd0f3dda72fcacc6288ddae24e2d19" title="Constructs an exotic quadrature from a sparse grid object.">getExoticQuadrature()</a> but the weight function is defined by a lambda expression.  <a href="group__TasmanianAddonsExoticQuad.html#ga61aaac9fcfbb38c259453c3029f20cc0">More...</a><br /></td></tr>
<tr class="separator:ga61aaac9fcfbb38c259453c3029f20cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section user"><dt>Exotic Quadrature</dt><dd>The Exotic Quadrature module of Tasmanian offers a collection of functions for generating one dimensional quadrature rules with weight functions that are not strictly non-negative. The quadrature rules are loaded inside TasGrid::CustomTabulated objects and be used in calls to <a class="el" href="group__TasmanianSG.html#ga734013b4f52c4d1d9a35d674b459e13a" title="Factory method, creates a new grid and calls TasmanianSparseGrid::makeGlobalGrid().">TasmanianSparseGrid::makeGlobalGrid()</a> to extend those to a multidimensional context.</dd></dl>
<dl class="section user"><dt></dt><dd>The integral of interest has the form \( \int_{-1}^{1} f(x) \rho(x) dx \) and it differs from the classical Gaussian rules by allowing the weight function \( \rho(x) \) to be negative in portions of the domain. We still require that the weight is integrable and bounded from below, i.e., \( \int_{-1}^{1} | \rho(x) | dx &lt; \infty \) and \( \rho(x) \geq c &gt; -\infty \).</dd></dl>
<dl class="section user"><dt></dt><dd>The quadrature consists of two components, one is a quadrature that uses classical Gaussian construction using the root of polynomials that are orthogonal with respect to a shifted positive weight \( \rho(x) + c \geq 0 \) and a correction term using Gauss-Legendre rule scaled by -c. While the asymptotic convergence rate is inferior to that of Gauss-Legendre, for small number of points the accuracy of the combined quadrature rule can be significantly greater. This advantage is further magnified in a sparse grid context where reaching the asymptotic regime for Gauss-Legendre may require a prohibitive number of points due to the curse of dimensionality.</dd></dl>
<dl class="section user"><dt></dt><dd>The weight can be defined either with a C++ lambda expression or a one-dimensional TasmanianSparseGrid object. The lambda expression will be evaluated at a large number of Gauss-Legendre points that will be used for a reference quadrature to build the orthogonal polynomial basis. In the case of a sparse grid object, only the loaded points and quadrature weights will be used, and no interpolation will be performed inbetween (i.e., we circumvent potential interpolation error). </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga2cfd0f3dda72fcacc6288ddae24e2d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2cfd0f3dda72fcacc6288ddae24e2d19">&#9670;&nbsp;</a></span>getExoticQuadrature() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TasGrid::CustomTabulated TasGrid::getExoticQuadrature </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTasGrid_1_1TasmanianSparseGrid.html">TasGrid::TasmanianSparseGrid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_symmetric</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs an exotic quadrature from a sparse grid object. </p>
<p>Constructs a set of one dimensional quadrature rules with respect to a 1D weight function approximated by <b>grid</b>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_levels</td><td>is the number of levels that should be computed </td></tr>
    <tr><td class="paramname">shift</td><td>is a real-valued scalar that needs to be added to the weight function to make it positive </td></tr>
    <tr><td class="paramname">grid</td><td>has dimension 1 and at least one loaded point, should use as many points as possible for better accuracy (up to some point where numerical stability is lost) </td></tr>
    <tr><td class="paramname">description</td><td>is a human readable string that can be used to identify the quadrature rule (could be empty) </td></tr>
    <tr><td class="paramname">is_symmetric</td><td>indicates whether to assume that the weight is symmetric, which allows for some stability improvements; symmetric means "even" on [-1, 1], which leads to all odd power polynomials integrating to zero; the same holds for shifted domains so long as the weight is "even" with respect to the mid-point of the domain.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TasGrid::CustomTabulated object holding the points and weights for the different levels of the quadrature</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::invalid_argument</td><td>if <b>grid</b> doesn't have a single input and output or no loaded points, or if the value of the weight function plus the shift is not non-negative</td></tr>
  </table>
  </dd>
</dl>
<p>The <b>grid</b> object is used in two ways: first, it defines a reference quadrature that will be used to compute the inner-product integrals that define orthogonal polynomials; second, it defines the values of the weight function \( \rho(x) \) at the quadrature points. Note that the values of the weight function will not be interpolated between the reference points.</p>
<p>Examples of symmetric weight functions are \( \sin(x) \), \( \sin(x) / x \), constant weight, and the Gauss-Chebyshev weights. On the other hand, \( \cos(x) \) is not symmetric in the context of this algorithm due to the shift that must be applied. </p>

</div>
</div>
<a id="ga61aaac9fcfbb38c259453c3029f20cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61aaac9fcfbb38c259453c3029f20cc0">&#9670;&nbsp;</a></span>getExoticQuadrature() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TasGrid::CustomTabulated TasGrid::getExoticQuadrature </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(double)&gt;&#160;</td>
          <td class="paramname"><em>weight_fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num_ref_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>description</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_symmetric</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Similar to <a class="el" href="group__TasmanianAddonsExoticQuad.html#ga2cfd0f3dda72fcacc6288ddae24e2d19" title="Constructs an exotic quadrature from a sparse grid object.">getExoticQuadrature()</a> but the weight function is defined by a lambda expression. </p>
<p>Constructs a CustomTabulated object holding the points and weights for the different levels of the quadrature for the given parameter <b>weight_fn</b>. The <b>num_ref_points</b> parameter sets the number of reference points from a Gauss-Legendre quadrature that will be used to compute the inner-product integrals that define the orthogonal polynomials. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<!-- <div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
<!--  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div> -->
</body>
</html>
